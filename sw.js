const CACHE_NAME='portfolio-v1.5';const CRITICAL_RESOURCES=['/','/index.html','/vendor/bootstrap/bootstrap.min.css','/css/style.min.css','/css/index.css','/css/detail.css','/css/login.css','/css/admin-complete.css','/js/app.min.js','/vendor/bootstrap/bootstrap.min.js','/vendor/bootstrap/popper.min.js'];const NON_CRITICAL_RESOURCES=['/vendor/waypoints/waypoint.min.js','/contactform/contactform.js'];self.addEventListener('install',event=>{event.waitUntil(caches.open(CACHE_NAME).then(cache=>{return cache.addAll(CRITICAL_RESOURCES);}).then(()=>{return caches.open(CACHE_NAME).then(cache=>cache.addAll(NON_CRITICAL_RESOURCES));}).then(()=>self.skipWaiting()));});self.addEventListener('activate',event=>{event.waitUntil(caches.keys().then(cacheNames=>{return Promise.all(cacheNames.map(cacheName=>{if(cacheName!==CACHE_NAME){return caches.delete(cacheName);}}));}).then(()=>self.clients.claim()));});self.addEventListener('fetch',event=>{if(event.request.method!=='GET')return;if(!event.request.url.startsWith(self.location.origin)){return;}event.respondWith(caches.match(event.request).then(response=>{if(response){if(!CRITICAL_RESOURCES.includes(new URL(event.request.url).pathname)){fetch(event.request).then(fetchResponse=>{if(fetchResponse.ok){const responseClone=fetchResponse.clone();caches.open(CACHE_NAME).then(cache=>cache.put(event.request,responseClone));}}).catch(()=>{});}return response;}return fetch(event.request).then(fetchResponse=>{if(!fetchResponse.ok){return fetchResponse;}const responseClone=fetchResponse.clone();caches.open(CACHE_NAME).then(cache=>cache.put(event.request,responseClone));return fetchResponse;});}));});self.addEventListener('sync',event=>{if(event.tag==='background-sync'){event.waitUntil(caches.open(CACHE_NAME).then(cache=>{return Promise.all(NON_CRITICAL_RESOURCES.map(url=>{return fetch(url).then(response=>{if(response.ok){return cache.put(url,response);}}).catch(()=>{});}));}));}});